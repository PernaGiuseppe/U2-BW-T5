const playlists = [
  {
    id: 1,
    titl: "Playlist Rock",
    description: "Una selezione dei migliori brani rock.",
    songs: 42,
    image: "./immagini.playlist/maxresdefault.jpg",
    tracks: [
      {
        id: 9997018,
        title: "Bohemian Rhapsody",
        artist: "Queen",
        duration: "5:55",
        album: "A Night at the Opera",
        albumID: 915785,
        artistID: 412,
      },
      {
        id: 92720046,
        title: "Back in Black",
        artist: "AC/DC",
        duration: "4:15",
        album: "Back in Black",
        albumID: 9410100,
        artistID: 115,
      },
      {
        id: 518458172,
        title: "Sweet Child O' Mine",
        artist: "Guns N' Roses",
        duration: "5:56",
        album: "Appetite for Destruction",
        albumID: 66644272,
        artistID: 663,
      },
      {
        id: 426703682,
        title: "Hotel California",
        artist: "Eagles",
        duration: "6:30",
        album: "Hotel California",
        albumID: 51350192,
        artistID: 210,
      },
      {
        id: 60840057,
        title: "Smoke on the Water",
        artist: "Deep Purple",
        duration: "5:40",
        album: "Machine Head",
        albumID: 5953987,
        artistID: 864,
      },
      {
        id: 92719900,
        title: "Highway to Hell",
        artist: "AC/DC",
        duration: "3:28",
        album: "Highway to Hell",
        albumID: 9410086,
        artistID: 115,
      },
      {
        id: 540202122,
        title: "Born to Be Wild",
        artist: "Steppenwolf",
        duration: "3:30",
        album: "Steppenwolf",
        albumID: 70494342,
        artistID: 1172,
      },
      {
        id: 1483825212,
        title: "Enter Sandman",
        artist: "Metallica",
        duration: "5:32",
        album: "Metallica (Black Album)",
        albumID: 256250622,
        artistID: 119,
      },
      {
        id: 518458142,
        title: "Paradise City",
        artist: "Guns N' Roses",
        duration: "6:45",
        album: "Appetite for Destruction",
        albumID: 66644272,
        artistID: 663,
      },
      {
        id: 78671026,
        title: "Whole Lotta Love",
        artist: "Led Zeppelin",
        duration: "5:34",
        album: "Led Zeppelin II",

        albumID: 7824595,
        artistID: 848,
      },
    ],
  },
  {
    id: 2,
    titl: "Playlist Chill",
    description: "Musica rilassante per ogni momento.",
    songs: 35,
    image: "./immagini.playlist/hq720.jpg",
    tracks: [
      {
        id: 124262674,
        title: "Sunset Lover",
        artist: "Petit Biscuit",
        duration: "3:58",
        album: "Presence",
        albumID: 13039372,
        artistID: 7912872,
      },
      {
        id: 61419261,
        title: "Weightless",
        artist: "Marconi Union",
        duration: "8:00",
        album: "Weightless",
        albumID: 6018893,
        artistID: 1242386,
      },
      {
        id: 3026736461,
        title: "Night Owl",
        artist: "Galimatias",
        duration: "3:55",
        album: "Blowsom EP",
        albumID: 650999361,
        artistID: 1622571,
      },
      {
        id: 142747710,
        title: "Cold Little Heart",
        artist: "Michael Kiwanuka",
        duration: "9:58",
        album: "Love & Hate",
        albumID: 15443992,
        artistID: 459578,
      },
      {
        id: 719670662,
        title: "Lost in Japan",
        artist: "Shawn Mendes",
        duration: "3:21",
        album: "Shawn Mendes",
        albumID: 105107222,
        artistID: 5962948,
      },
      {
        id: 486928932,
        title: "Lovely",
        artist: "Billie Eilish & Khalid",
        duration: "3:20",
        album: "dont smile at me",
        albumID: 61392882,
        artistID: 9635624,
      },
      {
        id: 136337268,
        title: "Ocean Eyes",
        artist: "Billie Eilish",
        duration: "3:20",
        album: "dont smile at me",
        albumID: 14581616,
        artistID: 9635624,
      },
      {
        id: 143172408,
        title: "Location",
        artist: "Khalid",
        duration: "3:39",
        album: "American Teen",
        albumID: 15498596,
        artistID: 362326,
      },
      {
        id: 657365552,
        title: "Talk",
        artist: "Khalid",
        duration: "3:17",
        album: "Free Spirit",

        albumID: 92014022,
        artistID: 362326,
      },
      {
        id: 553193312,
        title: "Better",
        artist: "Khalid",
        duration: "3:49",
        album: "Suncity",
        albumID: 72890222,
        artistID: 362326,
      },
    ],
  },
  {
    id: 3,
    titl: "Playlist Pop",
    description: "Una selezione dei migliori brani Pop.",
    songs: 24,
    image: "./immagini.playlist/ab67616d00001e02f2b33e6bcf2ae3325a423d5e.jpg",
    tracks: [
      {
        id: 908604612,
        title: "Blinding Lights",
        artist: "The Weeknd",
        duration: "3:20",
        album: "After Hours (2020)",

        albumID: 137217782,
        artistID: 4050205,
      },
      {
        id: 1703487577,
        title: "As it Was",
        artist: "Harry Styles",
        duration: "2:47",
        album: "Harry s House (2022)",
        albumID: 307085627,
        artistID: 5313805,
      },
      {
        id: 1976903157,
        title: "Anti-Hero",
        artist: "Taylor Swift",
        duration: "3:20",
        album: "Midnights (2022)",
        albumID: 368474187,
        artistID: 12246,
      },
      {
        id: 1124841682,
        title: "Levitating",
        artist: "Dua Lipa",
        duration: "3:23",
        album: "Future Nostalgia (2020)",
        albumID: 182811182,
        artistID: 8706544,
      },
      {
        id: 2105158337,
        title: "Flowers",
        artist: "Miley Cyrus",
        duration: "3:20",
        album: "Endless Summer Vacation (2023)",
        albumID: 395674277,
        artistID: 12436,
      },
      {
        id: 793163542,
        title: "Dont Start Now",
        artist: "Dua Lipa",
        duration: "3:03",
        album: "Future Nostalgia (2020)",
        albumID: 117053822,
        artistID: 8706544,
      },
      {
        id: 1280165222,
        title: "Peaches",
        artist: "Justin Bieber feat. Daniel Caesar & Giveon",
        duration: "3:18",
        album: "Justice (2021)",
        albumID: 215962322,
        artistID: 288166,
      },
      {
        id: 1484264492,
        title: "Shivers",
        artist: "Ed Sheeran",
        duration: "3:27",
        album: "(Equals) (2021)",
        albumID: 256337182,
        artistID: 384236,
      },
      {
        id: 1378342622,
        title: "good 4 u",
        artist: " Olivia Rodrigo",
        duration: "2:58",
        album: "SOUR (2021)",
        albumID: 231552772,
        artistID: 11152580,
      },
      {
        id: 1425844092,
        title: "Stay",
        artist: "The Kid LAROI & Justin Bieber",
        duration: "2:21",
        album: "F*CK LOVE 3: OVER YOU (2021)",

        albumID: 242430582,
        artistID: 51204222,
      },
    ],
  },
  {
    id: 4,
    titl: "Playlist Classic",
    description: "Musica rilassante per ogni momento.",
    songs: 35,
    image: "./immagini.playlist/ab67616d0000b2739474419f15773875a495eed3.jpg",
    tracks: [
      {
        id: 6644993,
        title: "Clair de Lune",
        artist: "Claude Debussy",
        duration: "5:10",
        album: "Suite Bergamasque (1905)",
        albumID: 614437,
        artistID: 5176,
      },
      {
        id: 79034866,
        title: "Nocturne Op. 9 No. 2",
        artist: "Frédéric Chopin",
        duration: "4:30",
        album: "Nocturnes, Op. 9 (1832)",
        albumID: 7857432,
        artistID: 8473,
      },
      {
        id: 25478821,
        title: "Moonlight Sonata (1st Movement)",
        artist: "Ludwig van Beethoven",
        duration: "5:32",
        album: "Piano Sonata No. 14 (1801)",
        albumID: 2422651,
        artistID: 6144,
      },
      {
        id: 17065960,
        title: "The Four Seasons: Spring",
        artist: "Antonio Vivaldi",
        duration: "3:25",
        album: "The Four Seasons (1725)",

        albumID: 1595402,
        artistID: 4081,
      },
      {
        id: 1439886,
        title: "Canon in D",
        artist: "Johann Pachelbel",
        duration: "6:00",
        album: "Canon and Gigue in D major (1680s)",
        albumID: 146497,
        artistID: 103040,
      },
      {
        id: 122579842,
        title: "Gymnopédie No. 1",
        artist: "Erik Satie",
        duration: "3:20",
        album: "Gymnopédies (1888)",
        albumID: 12828942,
        artistID: 67570,
      },
      {
        id: 67350403,
        title: "Swan Lake (Act II, Scene)",
        artist: "Pyotr Ilyich Tchaikovsky",
        duration: "3:45",
        album: "Swan Lake, Op. 20 (1876)",
        albumID: 6585541,
        artistID: 432540,
      },
      {
        id: 6058117,
        title: "Hungarian Dance No. 5",
        artist: "Johannes Brahms",
        duration: "2:20",
        album: "Hungarian Dances (1869)",
        albumID: 553175,
        artistID: 7128,
      },
      {
        id: 68301402,
        title: "Eine kleine Nachtmusik",
        artist: "Wolfgang Amadeus Mozart",
        duration: "5:50",
        album: "Serenade No. 13, K. 525 (1787)",
        albumID: 6688854,
        artistID: 298705,
      },
      {
        id: 849345402,
        title: "Adagio for Strings",
        artist: "Samuel Barber",
        duration: "8:40",
        album: "Adagio for Strings (1938)",
        albumID: 126018662,
        artistID: 4192810,
      },
    ],
  },
  {
    id: 5,
    titl: "Playlist Tecno",
    description: "Una selezione dei migliori brani rock.",
    songs: 42,
    image:
      "./immagini.playlist/techno-music-album-cover-template-design-54ad7cf78c858c37ba141bb421ac79ee_screen.jpg",
    tracks: [
      {
        id: 388277401,
        title: "Midnight",
        artist: "Charlotte de Witte",
        duration: "6:15",
        album: "Apollo EP (2023)",
        albumID: 45324441,
        artistID: 150457,
      },
      {
        id: 3845871,
        title: "Acid Eiffel",
        artist: "Laurent Garnier",
        duration: "13:00",
        album: "Acid Eiffel (1993)",
        albumID: 358883,
        artistID: 5469,
      },
      {
        id: 2393352885,
        title: "Your Mind",
        artist: "Adam Beyer & Bart Skils",
        duration: "8:04",
        album: "Your Mind (2018)",
        albumID: 471576415,
        artistID: 262460,
      },
      {
        id: 1902369237,
        title: "Age of Love (Charlotte de Witte & Enrico Sangiuliano Remix)",
        artist: "The Age of Love",
        duration: "8:14",
        album: "The Age of Love (2021 Remix)",
        albumID: 354033907,
        artistID: 991108,
      },
      {
        id: 14440894,
        title: "Bang The Acid",
        artist: "Damon Wild and Tim Taylor",
        duration: "6:08",
        album: "Live at Kosmos (2020)",
        albumID: 1324330,
        artistID: 1463533,
      },
      {
        id: 978183732,
        title: "Subzero",
        artist: "Ben Klock",
        duration: "6:46",
        album: "Subzero EP (2011)",
        albumID: 152238912,
        artistID: 178264,
      },
      {
        id: 819066552,
        title: "Planet X",
        artist: "Amelie Lens",
        duration: "6:30",
        album: "Planet X EP (2019)",
        albumID: 120503972,
        artistID: 1649557,
      },
      {
        id: 2291815645,
        title: "Lost",
        artist: "SHDDR",
        duration: "5:45",
        album: "Lost (2021)",
        albumID: 443768075,
        artistID: 7856702,
      },
      {
        id: 623893232,
        title: "The Bells",
        artist: "Jeff Mills",
        duration: "4:47",
        album: "Waveform Transmission Vol. 1 (1997)",
        albumID: 85641932,
        artistID: 8290,
      },
      {
        id: 145429556,
        title: "Ayo Technology",
        artist: "50 Cent",
        duration: "4:06",
        album: "Best Of 50 Cent",
        albumID: 15801900,
        artistID: 66,
      },
    ],
  },
  {
    id: 6,
    titl: "Playlist Reggeton",
    description: "Musica rilassante per ogni momento.",
    songs: 35,
    image: "./immagini.playlist/400x400bb.jpeg",
    tracks: [
      {
        id: 3165861441,
        title: "Gasolina",
        artist: "Daddy Yankee",
        duration: "3:13",
        album: "Barrio Fino (2004)",
        albumID: 691271171,
        artistID: 3839,
      },
      {
        id: 143783500,
        title: "Despacito",
        artist: "Luis Fonsi feat. Daddy Yankee",
        duration: "3:47",
        album: "Vida (2019)",
        albumID: 15579230,
        artistID: 6707,
      },
      {
        id: 493108632,
        title: "Felices los 4",
        artist: "Maluma",
        duration: "3:49",
        album: "F.A.M.E. (2018)",
        albumID: 62438782,
        artistID: 1424602,
      },
      {
        id: 1147324382,
        title: "Dákiti",
        artist: "Bad Bunny & Jhay Cortez",
        duration: "3:25",
        album: "El Último Tour del Mundo (2020)",
        albumID: 187470982,
        artistID: 5845951,
      },
      {
        id: 1741494317,
        title: "Tití Me Preguntó",
        artist: "Bad Bunny",
        duration: "4:04",
        album: "Un Verano Sin Ti (2022)",
        albumID: 316164367,
        artistID: 10583405,
      },
      {
        id: 820200292,
        title: "Baila Baila Baila",
        artist: "Ozuna",
        duration: "3:37",
        album: "Nibiru (2019)",
        albumID: 120696132,
        artistID: 4937383,
      },
      {
        id: 401393742,
        title: "Criminal",
        artist: "Natti Natasha & Ozuna",
        duration: "3:53",
        album: "IlumiNATTI (2019)",
        albumID: 47292752,
        artistID: 2829671,
      },
      {
        id: 1741494307,
        title: "Me Porto Bonito",
        artist: "Bad Bunny & Chencho Corleone",
        duration: "2:58",
        album: "Un Verano Sin Ti (2022)",
        albumID: 316164367,
        artistID: 10583405,
      },
      {
        id: 64848611,
        title: "Ella y Yo",
        artist: "Aventura & Don Omar",
        duration: "4:29",
        album: "God s Project (2005)",

        albumID: 6353736,
        artistID: 700,
      },
      {
        id: 889550982,
        title: "Safaera",
        artist: "Bad Bunny",
        duration: "4:55",
        album: "YHLQMDLG (2020)",
        albumID: 133878352,
        artistID: 10583405,
      },
    ],
  },
];

//  Recupera l'ID dalla query string (?id=6)
const urlParams = new URLSearchParams(window.location.search);
const playlistId = parseInt(urlParams.get("id"));

const playlist = playlists.find((p) => p.id === playlistId);

if (playlist) {
  document.getElementById("titl").textContent = playlist.titl;
  document.getElementById("description").textContent = playlist.description;
  document.getElementById("image").src = playlist.image;
  document.getElementById(
    "songs"
  ).textContent = `Contiene ${playlist.songs} brani`;
} else {
  document.body.innerHTML = "Playlist non ancora rubata.";
}
//  Trova la playlist giusta
const selectedPlaylist = playlists.find((pl) => pl.id === playlistId);

const container = document.getElementById("tracks-container");

// Inserisci i brani
if (selectedPlaylist) {
  selectedPlaylist.tracks.forEach((track, index) => {
    const row = document.createElement("div");
    row.className =
      "row align-items-center p-3 border-bottom border-secondary border-opacity-10 track-item";
    row.innerHTML = `
        <div class="col-1 text-center text-white-50">${index + 1}</div>
        <div class="col-5 col-sm-4 d-flex align-items-center gap-2">
          <button class="btn btn-link p-0 play-track-btn" data-track-index="${index}" title="Riproduci">
            <i class="bi bi-play-circle text-epi-cyan" style="font-size:1.3em;"></i>
          </button>
          <div class="fw-normal text-white">${track.title}</div>
         </div>
         <div class="col-4 col-sm-3 text-white-50"><a href="artist.html?artist=${
           track.artist
         }&id=${
      track.artistID
    }" class="fw-normal text-white-50 text-decoration-none">${
      track.artist
    }</a></div>
        <div class="col-2 d-none d-sm-block text-center text-white-50"><a href="album.html?id=${
          track.albumID
        }" class="fw-normal text-white-50 text-decoration-none">${
      track.album
    }</a></div>
        <div class="col-2 text-end text-white-50">${track.duration}</div>
       `;
    container.appendChild(row);
  });
  // Gestione click sui tasti play accanto alle canzoni
  setTimeout(() => {
    const playBtns = document.querySelectorAll(".play-track-btn");
    playBtns.forEach((btn) => {
      btn.onclick = function (e) {
        e.preventDefault();
        const idx = parseInt(btn.getAttribute("data-track-index"));
        if (!isNaN(idx) && selectedPlaylist.tracks[idx]) {
          window.albumTracks = selectedPlaylist.tracks;
          window.currentAlbumIndex = idx;
          window.playTrackById(selectedPlaylist.tracks[idx].id);
        }
      };
    });
  }, 100);
} else {
  container.innerHTML = `
      <div class="text-center text-white p-4">
        Playlist non ancora rubata.
      </div>
    `;
}

// Esporto le tracce della playlist e l'indice corrente in variabili globali per la mediabar
if (selectedPlaylist) {
  window.albumTracks = selectedPlaylist.tracks; // Rendo disponibili le tracce globalmente
  window.currentAlbumIndex = 0; // Indice della traccia attuale nella playlist
} else {
  window.albumTracks = [];
  window.currentAlbumIndex = undefined;
}

// Gestione tasto play grande della playlist
// Seleziono il bottone play grande (primo bottone con classe btn-epi-cyan e icona bi-play-fill)
const bigPlayBtn = document.querySelector(
  ".container-fluid .btn-epi-cyan.rounded-circle.me-4"
);
if (bigPlayBtn && selectedPlaylist && selectedPlaylist.tracks.length > 0) {
  bigPlayBtn.onclick = function () {
    // Aggiorno le variabili globali per la mediabar
    window.albumTracks = selectedPlaylist.tracks;
    window.currentAlbumIndex = 0;
    // Avvio la prima traccia della playlist nella mediabar
    window.playTrackById(selectedPlaylist.tracks[0].id);
  };
}

// Gestione tasto shuffle della playlist (sincronizza con mediabar)
// Seleziono il bottone shuffle della playlist (terzo bottone nella riga, icona bi-shuffle)
const playlistShuffleBtn = document.querySelector(
  ".container-fluid .bi-shuffle"
);
if (playlistShuffleBtn) {
  playlistShuffleBtn.parentElement.onclick = function () {
    // Inverte lo stato shuffle globale
    window.isAlbumShuffle = !window.isAlbumShuffle;
    // Aggiorna lo stato visivo del bottone
    if (window.isAlbumShuffle) {
      playlistShuffleBtn.style.color = "#00e1e7"; // Colore epi-cyan
    } else {
      playlistShuffleBtn.style.color = "";
    }
    // Sincronizza anche la mediabar (separato dallo stato locale della mediabar)
    // NB: mediabar.js già legge window.isAlbumShuffle per la logica di shuffle
  };
}
